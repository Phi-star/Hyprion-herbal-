<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Order Hyprion Herbal Capsules ‚Äì Fast Delivery Nationwide</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,700;0,900;1,400&family=DM+Sans:wght@300;400;500;600&display=swap" rel="stylesheet">
<style>
  :root {
    --green-dark: #1a3d2b;
    --green-mid: #2d6a4f;
    --green-light: #52b788;
    --green-pale: #b7e4c7;
    --gold: #d4af37;
    --gold-light: #f0d060;
    --cream: #fdf8f0;
    --cream-dark: #f5edd8;
    --text-dark: #1a1a1a;
    --text-light: #6b7280;
    --white: #ffffff;
    --error: #e74c3c;
    --success: #27ae60;
  }
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body { font-family: 'DM Sans', sans-serif; background: var(--cream); color: var(--text-dark); min-height: 100vh; }

  /* TOP NAV */
  nav {
    background: var(--green-dark);
    padding: 14px 5%;
    display: flex;
    align-items: center;
    justify-content: space-between;
  }
  .nav-brand { font-family: 'Playfair Display', serif; font-size: 1.4rem; color: white; font-weight: 900; text-decoration: none; }
  .nav-brand span { color: var(--gold); }
  .nav-back { color: rgba(255,255,255,0.75); text-decoration: none; font-size: 0.9rem; display: flex; align-items: center; gap: 6px; transition: color 0.2s; }
  .nav-back:hover { color: var(--gold-light); }

  /* PROGRESS BAR */
  .progress-bar-wrap {
    background: var(--green-mid);
    padding: 12px 5%;
    display: flex;
    align-items: center;
    gap: 8px;
  }
  .progress-step { display: flex; align-items: center; gap: 8px; }
  .step-bubble {
    width: 28px; height: 28px; border-radius: 50%;
    background: rgba(255,255,255,0.2); color: white;
    display: flex; align-items: center; justify-content: center;
    font-size: 0.8rem; font-weight: 700;
  }
  .step-bubble.active { background: var(--gold); color: var(--green-dark); }
  .step-bubble.done { background: var(--green-light); }
  .step-label { font-size: 0.8rem; color: rgba(255,255,255,0.8); }
  .step-line { flex: 1; height: 2px; background: rgba(255,255,255,0.2); }

  /* LAYOUT */
  .order-layout {
    max-width: 1100px; margin: 40px auto; padding: 0 5%;
    display: grid; grid-template-columns: 1fr 380px; gap: 36px;
    align-items: start;
  }

  /* FORM CARD */
  .form-card {
    background: white; border-radius: 24px; padding: 40px;
    box-shadow: 0 4px 30px rgba(0,0,0,0.08);
  }
  .form-title {
    font-family: 'Playfair Display', serif; font-size: 1.8rem;
    color: var(--green-dark); margin-bottom: 6px;
  }
  .form-subtitle { font-size: 0.9rem; color: var(--text-light); margin-bottom: 32px; }

  .form-section-heading {
    font-size: 0.78rem; font-weight: 700; text-transform: uppercase;
    letter-spacing: 0.1em; color: var(--green-mid);
    margin-bottom: 16px; padding-bottom: 8px;
    border-bottom: 2px solid var(--green-pale);
    display: flex; align-items: center; gap: 8px;
  }

  .form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 18px; margin-bottom: 24px; }
  .form-group { display: flex; flex-direction: column; gap: 6px; }
  .form-group.full { grid-column: 1 / -1; }

  label { font-size: 0.85rem; font-weight: 600; color: var(--text-dark); }
  label span.req { color: var(--error); margin-left: 3px; }

  input, select, textarea {
    padding: 13px 16px; border: 2px solid #e5e7eb; border-radius: 12px;
    font-family: inherit; font-size: 0.95rem; color: var(--text-dark);
    transition: all 0.2s; outline: none; background: #fafafa;
    width: 100%;
  }
  input:focus, select:focus, textarea:focus {
    border-color: var(--green-mid); background: white;
    box-shadow: 0 0 0 4px rgba(45,106,79,0.1);
  }
  input.error { border-color: var(--error); }
  .field-error { font-size: 0.78rem; color: var(--error); display: none; }

  textarea { resize: vertical; min-height: 90px; }

  .quantity-control {
    display: flex; align-items: center; gap: 0; border: 2px solid #e5e7eb;
    border-radius: 12px; overflow: hidden; background: #fafafa;
  }
  .qty-btn {
    width: 44px; height: 50px; border: none; background: var(--green-pale);
    color: var(--green-dark); font-size: 1.4rem; cursor: pointer;
    font-weight: 700; transition: background 0.2s;
  }
  .qty-btn:hover { background: var(--green-light); color: white; }
  .qty-input {
    flex: 1; text-align: center; border: none !important;
    box-shadow: none !important; font-weight: 700; font-size: 1.1rem;
    background: transparent !important;
  }

  /* PACKAGE SELECTOR */
  .package-options {
    display: grid; grid-template-columns: repeat(3, 1fr); gap: 14px; margin-bottom: 24px;
  }
  .package-option {
    border: 2px solid #e5e7eb; border-radius: 14px; padding: 16px;
    text-align: center; cursor: pointer; transition: all 0.25s; position: relative;
  }
  .package-option:hover { border-color: var(--green-light); }
  .package-option.selected {
    border-color: var(--green-mid); background: #f0f9f4;
    box-shadow: 0 0 0 3px rgba(45,106,79,0.15);
  }
  .package-option input[type="radio"] { position: absolute; opacity: 0; }
  .pkg-icon { font-size: 1.8rem; margin-bottom: 6px; }
  .pkg-name { font-weight: 700; font-size: 0.9rem; color: var(--green-dark); }
  .pkg-qty { font-size: 0.78rem; color: var(--text-light); margin-top: 2px; }
  .pkg-badge {
    position: absolute; top: -8px; right: 8px;
    background: var(--gold); color: var(--green-dark);
    font-size: 0.65rem; font-weight: 700; padding: 2px 8px; border-radius: 50px;
    text-transform: uppercase;
  }

  /* SUBMIT BUTTON */
  .submit-btn {
    width: 100%; padding: 18px; background: linear-gradient(135deg, var(--green-mid), var(--green-dark));
    color: white; border: none; border-radius: 14px; font-family: inherit;
    font-size: 1.05rem; font-weight: 700; cursor: pointer;
    transition: all 0.3s; box-shadow: 0 6px 20px rgba(45,106,79,0.35);
    display: flex; align-items: center; justify-content: center; gap: 10px;
    margin-top: 8px;
  }
  .submit-btn:hover { transform: translateY(-2px); box-shadow: 0 10px 30px rgba(45,106,79,0.45); }
  .submit-btn:disabled { opacity: 0.7; cursor: not-allowed; transform: none; }
  .btn-spinner { width: 20px; height: 20px; border: 3px solid rgba(255,255,255,0.3); border-top-color: white; border-radius: 50%; animation: spin 0.8s linear infinite; display: none; }

  /* ORDER SUMMARY SIDEBAR */
  .summary-card {
    background: var(--green-dark); border-radius: 24px; padding: 32px;
    color: white; position: sticky; top: 24px;
  }
  .summary-title {
    font-family: 'Playfair Display', serif; font-size: 1.3rem;
    color: var(--gold-light); margin-bottom: 20px;
    border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 16px;
  }

  .summary-product {
    display: flex; align-items: center; gap: 14px; margin-bottom: 24px;
    background: rgba(255,255,255,0.07); padding: 16px; border-radius: 14px;
  }
  .summary-product-img {
    width: 70px; height: 70px; background: rgba(255,255,255,0.1);
    border-radius: 10px; display: flex; align-items: center; justify-content: center;
    font-size: 2rem; overflow: hidden; flex-shrink: 0;
  }
  .summary-product-img img { width: 100%; height: 100%; object-fit: contain; padding: 4px; }
  .summary-product-info strong { display: block; font-size: 0.95rem; font-weight: 700; }
  .summary-product-info span { font-size: 0.8rem; color: rgba(255,255,255,0.65); }

  .summary-line {
    display: flex; justify-content: space-between; align-items: center;
    padding: 10px 0; border-bottom: 1px solid rgba(255,255,255,0.07);
    font-size: 0.9rem;
  }
  .summary-line .label { color: rgba(255,255,255,0.7); }
  .summary-line .value { font-weight: 600; }
  .summary-line.total {
    padding-top: 16px; border-bottom: none; margin-top: 4px;
  }
  .summary-line.total .label { font-size: 1rem; color: white; font-weight: 700; }
  .summary-line.total .value { font-family: 'Playfair Display', serif; font-size: 1.5rem; color: var(--gold-light); }

  .trust-items { margin-top: 24px; display: flex; flex-direction: column; gap: 10px; }
  .trust-item {
    display: flex; align-items: center; gap: 10px;
    font-size: 0.82rem; color: rgba(255,255,255,0.75);
  }
  .trust-item span:first-child { font-size: 1rem; }

  /* SUCCESS OVERLAY */
  .success-overlay {
    display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.85);
    z-index: 9999; align-items: center; justify-content: center;
  }
  .success-overlay.show { display: flex; }
  .success-box {
    background: white; border-radius: 24px; padding: 50px 40px;
    text-align: center; max-width: 480px; width: 90%;
    animation: scale-in 0.5s ease;
  }
  .success-icon { font-size: 4rem; margin-bottom: 16px; }
  .success-box h2 { font-family: 'Playfair Display', serif; font-size: 1.8rem; color: var(--green-dark); margin-bottom: 12px; }
  .success-box p { color: var(--text-light); line-height: 1.65; margin-bottom: 20px; }
  .order-id-display {
    background: var(--cream); border: 2px dashed var(--green-pale);
    border-radius: 12px; padding: 14px; font-weight: 700;
    color: var(--green-dark); font-size: 1rem; margin-bottom: 24px;
  }
  .success-btn {
    background: var(--green-dark); color: white; padding: 14px 36px;
    border-radius: 50px; font-weight: 700; cursor: pointer;
    border: none; font-family: inherit; font-size: 1rem;
    transition: all 0.3s;
  }
  .success-btn:hover { background: var(--green-mid); }

  @keyframes spin { to { transform: rotate(360deg); } }
  @keyframes scale-in { from { transform: scale(0.7); opacity: 0; } to { transform: scale(1); opacity: 1; } }

  @media (max-width: 900px) {
    .order-layout { grid-template-columns: 1fr; }
    .summary-card { position: static; }
    .package-options { grid-template-columns: 1fr 1fr; }
  }
  @media (max-width: 600px) {
    .form-grid { grid-template-columns: 1fr; }
    .package-options { grid-template-columns: 1fr; }
    .form-card { padding: 24px 20px; }
  }
</style>
</head>
<body>

<!-- NAV -->
<nav>
  <a href="/hyprion" class="nav-brand">Hyp<span>rion</span></a>
  <a href="/hyprion" class="nav-back">‚Üê Back to Main Page</a>
</nav>

<!-- PROGRESS -->
<div class="progress-bar-wrap">
  <div class="progress-step">
    <div class="step-bubble active" id="step1Bubble">1</div>
    <div class="step-label">Your Details</div>
  </div>
  <div class="step-line"></div>
  <div class="progress-step">
    <div class="step-bubble" id="step2Bubble">2</div>
    <div class="step-label">Confirmation</div>
  </div>
  <div class="step-line"></div>
  <div class="progress-step">
    <div class="step-bubble" id="step3Bubble">‚úì</div>
    <div class="step-label">Order Placed</div>
  </div>
</div>

<!-- LAYOUT -->
<div class="order-layout">

  <!-- FORM -->
  <div class="form-card">
    <h1 class="form-title">üõí Place Your Order</h1>
    <p class="form-subtitle">Fill in your details below. We'll contact you to confirm and arrange delivery.</p>

    <form id="orderForm" novalidate>

      <!-- PACKAGE SELECTION -->
      <div class="form-section-heading">üì¶ Choose Your Package</div>
      <div class="package-options" id="packageOptions">
        <label class="package-option selected" onclick="selectPackage(this, 1)">
          <input type="radio" name="package" value="1" checked>
          <div class="pkg-icon">üíä</div>
          <div class="pkg-name">Starter Pack</div>
          <div class="pkg-qty">1 Bottle</div>
        </label>
        <label class="package-option" onclick="selectPackage(this, 2)">
          <input type="radio" name="package" value="2">
          <div class="pkg-badge">Popular</div>
          <div class="pkg-icon">üíäüíä</div>
          <div class="pkg-name">Standard Pack</div>
          <div class="pkg-qty">2 Bottles</div>
        </label>
        <label class="package-option" onclick="selectPackage(this, 3)">
          <input type="radio" name="package" value="3">
          <div class="pkg-badge">Best Value</div>
          <div class="pkg-icon">üíäüíäüíä</div>
          <div class="pkg-name">Family Pack</div>
          <div class="pkg-qty">3 Bottles</div>
        </label>
      </div>

      <!-- PERSONAL DETAILS -->
      <div class="form-section-heading">üë§ Personal Information</div>
      <div class="form-grid">
        <div class="form-group">
          <label>Full Name <span class="req">*</span></label>
          <input type="text" id="fullName" name="fullName" placeholder="e.g. Adeyemi Okonkwo" required>
          <span class="field-error" id="fullNameError">Please enter your full name</span>
        </div>
        <div class="form-group">
          <label>Phone Number <span class="req">*</span></label>
          <input type="tel" id="phone" name="phone" placeholder="e.g. 08012345678" required>
          <span class="field-error" id="phoneError">Please enter a valid phone number</span>
        </div>
        <div class="form-group">
          <label>WhatsApp Number</label>
          <input type="tel" id="whatsapp" name="whatsapp" placeholder="If different from phone">
        </div>
        <div class="form-group">
          <label>Email Address</label>
          <input type="email" id="email" name="email" placeholder="Optional">
        </div>
      </div>

      <!-- DELIVERY DETAILS -->
      <div class="form-section-heading">üöö Delivery Information</div>
      <div class="form-grid">
        <div class="form-group">
          <label>State <span class="req">*</span></label>
          <select id="state" name="state" required>
            <option value="">-- Select your state --</option>
            <option>Abia</option><option>Adamawa</option><option>Akwa Ibom</option><option>Anambra</option>
            <option>Bauchi</option><option>Bayelsa</option><option>Benue</option><option>Borno</option>
            <option>Cross River</option><option>Delta</option><option>Ebonyi</option><option>Edo</option>
            <option>Ekiti</option><option>Enugu</option><option>FCT ‚Äì Abuja</option><option>Gombe</option>
            <option>Imo</option><option>Jigawa</option><option>Kaduna</option><option>Kano</option>
            <option>Katsina</option><option>Kebbi</option><option>Kogi</option><option>Kwara</option>
            <option>Lagos</option><option>Nasarawa</option><option>Niger</option><option>Ogun</option>
            <option>Ondo</option><option>Osun</option><option>Oyo</option><option>Plateau</option>
            <option>Rivers</option><option>Sokoto</option><option>Taraba</option><option>Yobe</option>
            <option>Zamfara</option>
          </select>
          <span class="field-error" id="stateError">Please select your state</span>
        </div>
        <div class="form-group">
          <label>City / LGA <span class="req">*</span></label>
          <input type="text" id="city" name="city" placeholder="e.g. Ikeja" required>
          <span class="field-error" id="cityError">Please enter your city</span>
        </div>
        <div class="form-group full">
          <label>Delivery Address <span class="req">*</span></label>
          <input type="text" id="address" name="address" placeholder="House number, street name, nearest landmark" required>
          <span class="field-error" id="addressError">Please enter your delivery address</span>
        </div>
      </div>

      <!-- ORDER NOTES -->
      <div class="form-section-heading">üìù Additional Notes</div>
      <div class="form-group" style="margin-bottom:28px">
        <label>Special Instructions (Optional)</label>
        <textarea id="notes" name="notes" placeholder="Any special delivery instructions or questions..."></textarea>
      </div>

      <!-- HOW DID YOU HEAR -->
      <div class="form-grid" style="margin-bottom:28px">
        <div class="form-group">
          <label>How did you hear about us?</label>
          <select id="source" name="source">
            <option value="">-- Select --</option>
            <option>Facebook</option>
            <option>Instagram</option>
            <option>WhatsApp</option>
            <option>Twitter/X</option>
            <option>Friend/Family</option>
            <option>Google Search</option>
            <option>TV/Radio</option>
            <option>Other</option>
          </select>
        </div>
        <div class="form-group">
          <label>Referral Code (if any)</label>
          <input type="text" id="referral" name="referral" placeholder="Optional">
        </div>
      </div>

      <div id="formMessage" style="display:none; padding:14px; border-radius:10px; margin-bottom:16px; font-size:0.9rem;"></div>

      <button type="submit" class="submit-btn" id="submitBtn">
        <div class="btn-spinner" id="btnSpinner"></div>
        <span id="btnText">‚úÖ Confirm My Order ‚Äì Place Now</span>
      </button>

      <p style="text-align:center; font-size:0.78rem; color:var(--text-light); margin-top:14px">
        üîí Your information is safe and secure. We'll call to confirm your order before delivery.
      </p>
    </form>
  </div>

  <!-- SUMMARY SIDEBAR -->
  <div class="summary-card">
    <div class="summary-title">üìã Order Summary</div>

    <div class="summary-product">
      <div class="summary-product-img" id="summaryProductImg">üíä</div>
      <div class="summary-product-info">
        <strong>Hyprion Herbal Capsules</strong>
        <span>Natural Blood Pressure Support</span>
      </div>
    </div>

    <div class="summary-line">
      <span class="label">Package</span>
      <span class="value" id="summaryPackage">Starter Pack (1 Bottle)</span>
    </div>
    <div class="summary-line">
      <span class="label">Delivery State</span>
      <span class="value" id="summaryState">Not selected</span>
    </div>
    <div class="summary-line">
      <span class="label">Delivery</span>
      <span class="value" style="color:#52b788">FREE üöö</span>
    </div>
    <div class="summary-line total">
      <span class="label">Payment on Delivery</span>
      <span class="value">COD</span>
    </div>

    <div class="trust-items">
      <div class="trust-item"><span>üåø</span><span>100% Herbal ‚Äì No harmful chemicals</span></div>
      <div class="trust-item"><span>üöö</span><span>Free nationwide delivery</span></div>
      <div class="trust-item"><span>üí≥</span><span>Pay on delivery ‚Äì No upfront payment</span></div>
      <div class="trust-item"><span>üìû</span><span>We call to confirm before shipping</span></div>
      <div class="trust-item"><span>üîÑ</span><span>Easy returns if not satisfied</span></div>
      <div class="trust-item"><span>‚úÖ</span><span>NAFDAC Registered Product</span></div>
    </div>
  </div>
</div>

<!-- SUCCESS OVERLAY -->
<div class="success-overlay" id="successOverlay">
  <div class="success-box">
    <div class="success-icon">‚úÖ</div>
    <h2>Order Placed Successfully!</h2>
    <p>Thank you for ordering Hyprion Herbal Capsules. Our team will call you shortly to confirm your order and arrange delivery.</p>
    <div class="order-id-display" id="orderIdDisplay">Order ID: HYP-LOADING</div>
    <p style="font-size:0.85rem; margin-bottom:24px">üìû Please keep your phone nearby. We'll contact you within 24 hours.</p>
    <button class="success-btn" onclick="window.location.href='/hyprion'">‚Üê Back to Main Page</button>
  </div>
</div>

<script>
// =======================
// AUTO-LOAD PRODUCT IMAGE
// =======================
async function loadSummaryImage() {
  const img_container = document.getElementById('summaryProductImg');
  const extensions = ['jpg', 'jpeg', 'png', 'webp'];
  const names = ['1', 'product', 'hyprion', 'capsule', 'bottle'];
  for (const name of names) {
    for (const ext of extensions) {
      const src = `img/Hyprion/${name}.${ext}`;
      const exists = await new Promise(res => {
        const i = new Image(); i.onload = () => res(true); i.onerror = () => res(false); i.src = src;
      });
      if (exists) { img_container.innerHTML = `<img src="${src}" alt="Hyprion">`; return; }
    }
  }
}
loadSummaryImage();

// =======================
// PACKAGE SELECTION
// =======================
const packageLabels = {1: 'Starter Pack (1 Bottle)', 2: 'Standard Pack (2 Bottles)', 3: 'Family Pack (3 Bottles)'};
let selectedPackage = 1;

function selectPackage(el, pkgNum) {
  document.querySelectorAll('.package-option').forEach(o => o.classList.remove('selected'));
  el.classList.add('selected');
  selectedPackage = pkgNum;
  document.getElementById('summaryPackage').textContent = packageLabels[pkgNum];
}

// =======================
// STATE UPDATE
// =======================
document.getElementById('state').addEventListener('change', function() {
  document.getElementById('summaryState').textContent = this.value || 'Not selected';
});

// =======================
// FORM VALIDATION
// =======================
function validateField(id, errorId, condition) {
  const el = document.getElementById(id);
  const errEl = document.getElementById(errorId);
  if (condition) {
    el.classList.remove('error');
    if (errEl) errEl.style.display = 'none';
    return true;
  } else {
    el.classList.add('error');
    if (errEl) errEl.style.display = 'block';
    return false;
  }
}

// =======================
// ORDER SUBMISSION
// =======================
document.getElementById('orderForm').addEventListener('submit', async function(e) {
  e.preventDefault();

  const fullName = document.getElementById('fullName').value.trim();
  const phone = document.getElementById('phone').value.trim();
  const state = document.getElementById('state').value;
  const city = document.getElementById('city').value.trim();
  const address = document.getElementById('address').value.trim();

  const v1 = validateField('fullName', 'fullNameError', fullName.length >= 2);
  const v2 = validateField('phone', 'phoneError', /^[0-9+\s\-]{7,15}$/.test(phone));
  const v3 = validateField('state', 'stateError', state !== '');
  const v4 = validateField('city', 'cityError', city.length >= 2);
  const v5 = validateField('address', 'addressError', address.length >= 5);

  if (!v1 || !v2 || !v3 || !v4 || !v5) {
    const msg = document.getElementById('formMessage');
    msg.style.display = 'block';
    msg.style.background = '#fff5f5';
    msg.style.color = '#c0392b';
    msg.style.border = '1px solid #e74c3c';
    msg.textContent = '‚ö†Ô∏è Please fill in all required fields correctly.';
    return;
  }

  const btn = document.getElementById('submitBtn');
  const spinner = document.getElementById('btnSpinner');
  const btnText = document.getElementById('btnText');
  btn.disabled = true;
  spinner.style.display = 'block';
  btnText.textContent = 'Placing Your Order...';

  const orderData = {
    fullName,
    phone,
    whatsapp: document.getElementById('whatsapp').value.trim(),
    email: document.getElementById('email').value.trim(),
    state,
    city,
    address,
    notes: document.getElementById('notes').value.trim(),
    source: document.getElementById('source').value,
    referral: document.getElementById('referral').value.trim(),
    package: packageLabels[selectedPackage],
    packageQty: selectedPackage,
    timestamp: new Date().toISOString()
  };

  try {
    const response = await fetch('/api/hyprion-order', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(orderData)
    });

    const result = await response.json();

    if (response.ok && result.success) {
      // Update order ID in success popup
      document.getElementById('orderIdDisplay').textContent = 'Order ID: ' + (result.orderId || 'HYP-' + Date.now());
      document.getElementById('step1Bubble').classList.remove('active'); document.getElementById('step1Bubble').classList.add('done');
      document.getElementById('step2Bubble').classList.add('done');
      document.getElementById('step3Bubble').classList.add('active');
      document.getElementById('successOverlay').classList.add('show');
    } else {
      throw new Error(result.message || 'Order failed');
    }
  } catch(err) {
    const msg = document.getElementById('formMessage');
    msg.style.display = 'block';
    msg.style.background = '#fff5f5';
    msg.style.color = '#c0392b';
    msg.style.border = '1px solid #e74c3c';
    msg.textContent = '‚ùå ' + (err.message || 'Something went wrong. Please try again or call us directly.');
    btn.disabled = false;
    spinner.style.display = 'none';
    btnText.textContent = '‚úÖ Confirm My Order ‚Äì Place Now';
  }
});
</script>

</body>
</html>
